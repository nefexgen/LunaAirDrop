# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~СПИСОК СОБЫТИЙ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ #
# CLICK_CLOSE - клик по закрытому аирдропу
# CLICK_OPEN - клик по открытому аирдропу
# TIMER - вызывается каждую секунду
# START_EVENT - когда аирдроп появляется
# END_EVENT - когда аирдроп исчезает
# UNLOCK_EVENT - когда аирдроп разблокируется
# FIRST_OPEN - когда кто-то открывает аирдроп впервые
# SUMMONER - когда кто-то призывает аирдроп
# ACTIVATE - когда аирдроп активируется (срабатывает если start-countdown-after-click = true)
# STOP_WHEN_EMPTY - вызывается когда аирдроп заканчивается из-за опустошения
# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~СПИСОК ПРОВЕРОК~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ #
# NUMERICAL_CHECK - числовая проверка. Например, input '{time-to-open} == 60'
# LOGICAL_CHECK - логическая проверка. Например, input '{airdrop-is-open}'
# STRING_CHECK - сравнение строк. Например, input '{airdrop-is-open} == true'
# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ВНУТРЕННИЕ ПЛЕЙСХОЛДЕРЫ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ #
# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ЧИСЛОВЫЕ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ #
# {time-to-open} - время в секундах до открытия
# {time-to-start} - время в секундах до появления аирдропа
# {time-to-end} - время в секундах до окончания аирдропа
# == если числа равны (10 == 10)
# != если числа не равны (10 != 9)
# > если первое число больше второго (10 > 9)
# < если первое число меньше второго (9 < 10)
# >= если первое число больше или равно второму (10 >= 10)
# <= если первое число меньше или равно второму (10 <= 10)
# % остаток от деления (10 % 10 == 0) 10 / 10 = 1.0, значит остаток 0
# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ЛОГИЧЕСКИЕ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ #
# {it-was-open} - Был ли аирдроп открыт
# {airdrop-is-open} - true если аирдроп открыт
# {airdrop-is-start} - true если аирдроп появился
# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~СРАВНЕНИЕ СТРОК~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# == - если строки равны
# != - если строки не равны
# contains - если строка содержит
# !contains - если строка не содержит
# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~КОМАНДЫ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ #
# [MESSAGE] - Отправить сообщение игроку
# [MESSAGE_ALL] - Отправить сообщение всем игрокам
# [TITLE] - Отправить тайтл игроку (текст в центре экрана)
# [TITLE_ALL] - Отправить тайтл всем игрокам
# [ACTIONBAR] - Отправить actionbar сообщение игроку (текст над хотбаром)
# [ACTIONBAR_ALL] - Отправить actionbar сообщение всем игрокам
# [CONSOLE] - Выполнить команду от консоли
# [PLAYER] - Выполнить команду от игрока
# [SOUND] - Проиграть звук игроку
# [SOUND_ALL] - Проиграть звук всем игрокам
# [EFFECT_START-<ИМЯ>-<id генерации>] - Заспавнить эффект на локации аирдропа
# [EFFECT_STOP-<id>] - Остановить эффект
# [EFFECT_STOP_ALL] - Остановить все эффекты аирдропа
# [SET_MATERIAL_<МАТЕРИАЛ>] - Установить материал аирдропа
# [SCHEMATICS_PASTE-<имя>] - Вставить схематику
# [SCHEMATICS_REMOVE] - Удалить схематику
# [SET_TIME_START-<время>] - Установить время до старта в секундах
# [SET_TIME_UNLOCK-<время>] - Установить время до разблокировки в секундах
# [SET_TIME_END-<время>] - Установить время до конца в секундах
# [SET_REGION] - Установить регион
# [SET_HOLO_TIME_TO_START] - Заспавнить голограмму где появится аирдроп
# [CALL-<слушатель>] - Вызвать слушатель
# [NEAR-PLAYERS=<радиус>] перебрать всех игроков в радиусе. Используется как [NEAR-PLAYERS=10] {CALL-test}
# [RUN_JS=<jsname.js>] запустить скрипт
# [NEW_BOSSBAR] - Создать босс-бар
# [BOSSBAR] - Изменить босс-бар
# [REMOVE_BOSSBAR] - Удалить босс-бар
# [ERROR] - Вывести ошибку в консоль
# [LOGGER] - Вывести лог в консоль
# [PLAYER-SET-ITEM-<слот>=<материал>] - Установить предмет в слот игрока
# [SUB_TITLE] - Субтитр
# [SCHEDULER] - слушатель выполнится в отдельном потоке
# [ASYNC] - слушатель выполнится в отдельном асинхронном потоке
# [LATER-<время>] - слушатель выполнится с задержкой в тиках
###
# [LATER-<время>] - работает только в комбинации с [SCHEDULER] или [ASYNC]
# [SCHEDULER], [ASYNC], [LATER-<время>] - выполняются перед проверкой условий и неважно где эти команды расположены
######################################################################################
listeners:
  #TIMER#
  alert-5:
    description: '&6Сообщение об открытии через 5 секунд'
    event: 'TIMER'
    requirement:
      check-1:
        type: 'NUMERICAL_CHECK'
        input: '{time-to-open} == 5'
    commands:
      - '[MESSAGE_ALL] {air-name}&7 откроется через 5 секунд'

  alert-4:
    description: '&6Сообщение об открытии через 10 секунд'
    event: 'TIMER'
    requirement:
      check-1:
        type: 'NUMERICAL_CHECK'
        input: '{time-to-open} == 10'
    commands:
      - '[MESSAGE_ALL] {air-name}&7 откроется через 10 секунд'

  anim:
    description: '&6Анимация'
    event: 'TIMER'
    requirement:
      check-1:
        type: 'NUMERICAL_CHECK'
        input: '{time-to-open} % 2 == 0'
      check-2:
        type: 'LOGICAL_CHECK'
        input: '{!airdrop-is-open}'
      check-3:
        type: 'LOGICAL_CHECK'
        input: '{airdrop-is-start}'
    commands:
      - '[SET_MATERIAL_LIME_WOOL]'
    deny-commands:
      - '[CALL-anim-2]'

  alert-start:
    description: '&6Сообщение о появлении через 30 секунд'
    event: 'TIMER'
    requirement:
      check-1:
        type: 'NUMERICAL_CHECK'
        input: '{time-to-start} == 30'
    commands:
      - '[MESSAGE_ALL] {air-name}&7 появится через 30 секунд!'

  #START_EVENT#
  spawn-particle:
    description: '&6Спавнит частицы'
    event: 'START_EVENT'
    requirement:
      check-1:
        type: 'STRING_CHECK'
        input: '{use-player-location} == false'
    commands:
      - '[EFFECT_START-ef=3-ef_helix]'
      - '[EFFECT_START-ef=6-ef_rnd]'
    deny-commands:
      - '[CALL-remove_summoner_block]'
      - '[SET_MATERIAL_{material-locked}]'


  alert:
    description: '&6Отправляет сообщение всем о появлении аирдропа'
    event: 'START_EVENT'
    commands:
      - '[MESSAGE_ALL] {air-name}&7 появился! Координаты: &6{x} {y} {z}'
      - '[TITLE_ALL] {air-name}&7 появился!'
      - '[SOUND_ALL] BLOCK_BEACON_POWER_SELECT'

  #END_EVENT#
  end:
    description: '&6Завершение аирдропа'
    event: 'END_EVENT'
    requirement:
      check-1:
        type: 'STRING_CHECK'
        input: '{use-player-location} == true'
    commands:
      - '[EFFECT_STOP_ALL]'
      - '[MESSAGE_ALL] {air-name}&7 завершился!'
      - '[CALL-remove_summoner_block]'
    deny-commands:
      - '[EFFECT_STOP_ALL]'
      - '[MESSAGE_ALL] {air-name}&7 завершился!'

  alert-end:
    description: '&6Сообщение о завершении'
    event: 'END_EVENT'
    commands:
      - '[MESSAGE_ALL] {air-name}&7 исчез!'

  #Others#
  alert-open:
    description: '&6Сообщение об открытии'
    event: 'UNLOCK_EVENT'
    commands:
      - '[MESSAGE_ALL] {air-name}&7 открыт!'

  ACTIVATE:
    description: '&6Сообщение об активации аирдропа. Также запускает эффект'
    event: 'ACTIVATE'
    commands:
      - '[MESSAGE_ALL] &7Игрок &6%player_name% &7активировал {air-name}'
      - '[MESSAGE] {air-name} &aактивирован!'
      - '[EFFECT_START-ef=5=1-ef_circle]'
      - '[SOUND_ALL] UI_TOAST_CHALLENGE_COMPLETE'

  spawn-summoner-alert:
    description: '&6Отправляет сообщение, что игрок призвал аирдроп'
    event: 'SUMMONER'
    commands:
      - '[MESSAGE_ALL] &7Игрок &6%player_name% &7призвал {air-name}&7!'
      - '[SET_TIME_START-31]'


  chest-closed:
    description: '&6Отправляет сообщение игроку, что аирдроп закрыт'
    event: 'CLICK_CLOSE'
    commands:
      - '[MESSAGE] {air-name} &cзакрыт!'
      - '[SOUND] BLOCK_BARREL_CLOSE'

  chest-open:
    description: '&6Проигрывает звук игроку при клике на аирдроп'
    event: 'CLICK_OPEN'
    commands:
      - '[SOUND] BLOCK_BARREL_OPEN'


  spawn-summoner:
    description: '&6Спавнит частицы, если аирдроп призван игроком'
    event: 'SUMMONER'
    requirement:
      check-1:
        type: 'STRING_CHECK'
        input: '{use-player-location} == true'
    commands:
      - '[SET_MATERIAL_SOUL_CAMPFIRE]-offsets'
      - '[SET_REGION]'
      - '[EFFECT_START-ef=3-ef_helix]'
      - '[EFFECT_START-ef=6-ef_rnd]'
      - '[SET_HOLO_TIME_TO_START]-offsets'
      - '[SOUND_ALL] UI_TOAST_CHALLENGE_COMPLETE'

  anim-2:
    description: '&6Анимация'
    event: 'NONE'
    requirement:
      check-1:
        type: 'LOGICAL_CHECK'
        input: '{!airdrop-is-open}'
      check-2:
        type: 'LOGICAL_CHECK'
        input: '{airdrop-is-start}'
    commands:
      - '[SET_MATERIAL_RED_WOOL]'

  remove_summoner_block:
    description: '&6Удаляет блок призыва'
    event: 'NONE'
    commands:
      - '[SET_MATERIAL_AIR]-offsets'

  steal:
    description: '&6Когда игрок использует чит для кражи из сундука'
    event: 'PLAYER_STEAL'
    commands:
      - '[CONSOLE] kick &6%player_name% &7cheat'
